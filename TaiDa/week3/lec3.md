#! https://zhuanlan.zhihu.com/p/426994048
# Lec3. Forward Kinematics

> å¾ˆæŠ±æ­‰æœ¬ç¯‡æ–‡ç« ä¸­çš„è¡¨æ ¼åœ¨çŸ¥ä¹ä¸­éƒ½æ— æ³•æ˜¾ç¤ºï¼Œæ›´å¥½çš„è§‚çœ‹ä½“éªŒå¯ä»¥ç§»æ­¥åˆ°æˆ‘çš„ [github](https://github.com/Alexbeast-CN/Uob_Robotics/blob/main/TaiDa/week3/lec3.md)

æ­¤å¤„çš„æ­£å‘è¿åŠ¨å­¦çš„å¯¹è±¡æ˜¯æœºæ¢°è‡‚çš„è¿åŠ¨çŠ¶æ€ã€‚ä¸€ä¸ªæœºæ¢°è‡‚ç”±å¤šä¸ªè¿æ†(Link) å’Œé“¾æ¥ä»–ä»¬çš„å…³èŠ‚(Joint) ç»„æˆã€‚å…³èŠ‚å¯ä»¥ä¸ºæœºæ¢°è‡‚äº§ç”Ÿç§»åŠ¨å’Œè½¬åŠ¨çš„è¿åŠ¨ï¼Œä»è€Œä½¿å¾—æœºæ¢°è‡‚çš„æœ«ç«¯åˆ°è¾¾æŒ‡å®šçš„ä½ç½®ã€‚è®©æˆ‘ä»¬ä»¥è¿™æ ·çš„æ–¹å¼æ€è€ƒçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±åœ¨è¿ç”¨æ­£å‘è¿åŠ¨å­¦äº†ã€‚

## 2.1 æœºæ¢°è‡‚å‡ ä½•æè¿°æ–¹å¼

æœºæ¢°è‡‚çš„è¿åŠ¨ç”±ä¸¤ä¸ªå…³é”®å…ƒç´ ç»„æˆï¼š

- å…³èŠ‚(Joint):
    - æ¯ä¸€ä¸ªæ—‹è½¬ (revolute) æˆ– å¹³ç§» (prismatic) çš„ joint å…·æœ‰ 1 DOF
    - æ—‹è½¬è½´å’Œå¹³ç§»è½´æ˜¯å›ºå®šä¸å˜çš„ï¼ˆè¿™ä¸€ç‚¹åé¢ä¼šè¯¦ç»†è®²è§£ï¼‰

- è¿æ†(Link):
    - è¿™é‡Œæ‰€è®¨è®ºçš„è¿æ†å‡ä¸ºåˆšä½“ã€‚
    - ç¼–å·æ–¹å¼ä¸ºï¼š
      - åœ°æ†ï¼šlink0
      - ä¸åœ°æ†å‘è¿çš„ç¬¬ä¸€ä¸ªè¿æ†: link1
      - ç¬¬äºŒä¸ªå¯è¿åŠ¨çš„è¿æ†: link2

![ ](pics/1.png)

æˆ‘ä»¬åœ¨æ¯ä¸€ä¸ª Joint çš„ä½ç½®åˆ›å»º frame ç”¨æ¥æè¿°æœºæ¢°å†…éƒ¨ç»“æ„çš„åæ ‡å˜æ¢ã€‚å¯¹äºä¸Šå›¾æ¥è¯´ï¼Œå°±æ˜¯åœ¨æ¯ä¸€ä¸ªç»¿ç‚¹çš„ä½ç½®åˆ›å»º frameã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ä¸Šä¸€ç« å­¦ä¹ çš„å†…å®¹æ¥æè¿°æœºæ¢°è‡‚çš„åæ ‡å˜æ¢äº†ã€‚

å…·ä½“æ¥è¯´ï¼Œå¯¹äºç›¸é‚»ä¸¤ä¸ª frames ä»–ä»¬ä¹‹é—´ä¼šå‘ç”Ÿæ—‹è½¬å’Œå¹³ç§»ã€‚

![ ](pics/2.png)

ä¸ºäº†æ–¹ä¾¿æè¿°ï¼Œæˆ‘ä»¬å°†æ¯ä¸€ä¸ª frame çš„ z è½´ç©¿è¿‡ jointï¼Œæ¯ä¸€ä¸ª x è½´æŒ‡å‘ä¸‹ä¸€ä¸ª joint çš„æ–¹å‘ï¼Œä¸ $Z_{i-1}$ å’Œ $Z_{i}$ è½´å‚ç›´ã€‚å†ç”±å³æ‰‹å®šåˆ™ç¡®å®š y è½´çš„æ–¹å‘ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚å¯¹äºåæ ‡çš„å˜æ¢ï¼Œæˆ‘ä»¬é¦–å…ˆè€ƒè™‘æ—‹è½¬ï¼Œä»{i} å˜æ¢åˆ° {i-1}, x è½´æ—‹è½¬äº† $\alpha_{i-1}$ï¼Œz è½´æ—‹è½¬äº† $\theta _i$ã€‚å†è€ƒè™‘å¹³ç§»ï¼Œå…ˆæ²¿ç€ z è½´å¹³ç§»äº† $d_i$ï¼Œå†æ²¿ç€ x è½´å¹³ç§»äº† $a_{i-1}$ã€‚

- è‹¥æ˜¯ revolute joint åˆ™ $\theta _i$ æ˜¯ä¸€ä¸ªå˜é‡ï¼Œå…¶ä½™å‡ä¸ºå¸¸æ•°ã€‚
- è‹¥æ˜¯ prismatic joint åˆ™ $a_{i-1}$ æ˜¯ä¸€ä¸ªå˜é‡ï¼Œå…¶ä½™å‡ä¸ºå¸¸æ•°ã€‚

ä¸Šé¢æ‰€è¯´çš„æ˜¯ä¸€èˆ¬çš„ä¸¤ä¸ª joint ä¹‹é—´çš„æƒ…å†µã€‚å¯¹äºåœ°æ†å’Œæœ€åä¸€ä¸ªæ†æƒ…å†µè¦ç‰¹åˆ«ä¸€ç‚¹ã€‚

- åœ°æ†ï¼š
  - revolute joint: 
  $$\begin{matrix}
      a_{0} = 0& \alpha_{0}=0&d_{1}=0& \theta _1 \ is \ a \ variable
  \end{matrix}$$
  - prismatic joint: 
  $$\begin{matrix}
      a_{0} = 0& \alpha_{0}=0&\theta _1 =0& d_{1}\ is \ a \ variable
  \end{matrix}$$

- æœ«ç«¯
  - revolute joint: 
  $$\begin{matrix}
      Z_{i} = 0& \alpha_{i}=0&a_{i}=0& \theta _i \ is \ a \ variable
  \end{matrix}$$
  - prismatic joint: 
  $$\begin{matrix}
      Z_{i} = 0& \alpha_{i}=0&\theta _i =0& a_{i}\ is \ a \ variable
  \end{matrix}$$

![ ](pics/3.png)

## 2.2 Denavit-Hartenberg (DH) è¡¨è¾¾æ³• (Craig version)

ä¸Šé¢æ‰€æè¿°çš„æ–¹æ³•å°±æ˜¯ DH è¡¨è¾¾æ³•ï¼Œå³ï¼š

ä½¿ç”¨ $a, \alpha, d, \theta$ æ¥æè¿°ç›¸é‚» link ä¹‹é—´çš„å˜æ¢ã€‚

## 2.3 Link Transformation

æŒ‰ç…§ DH çš„æ–¹å¼æ¥å†™ link transformation çš„æ–¹ç¨‹å¼ï¼š

$$\begin{aligned}
    ^{i-1}P &=  ^{i-1}_{i}T \ ^{i}P\\
            &= R_x\ T_x \ R_z \ T_z\\
            &=\left[
            \begin{matrix}
                    ğ‘\theta _ğ‘–&âˆ’ğ‘ \theta _ğ‘–&0&ğ‘_{ğ‘–âˆ’1}\\
                    ğ‘ \theta _ğ‘–ğ‘\alpha _{ğ‘–âˆ’1}&ğ‘\theta _ğ‘–ğ‘\theta _{ğ‘–âˆ’1}&âˆ’ğ‘ \alpha _{ğ‘–âˆ’1}&âˆ’ğ‘ \alpha _{ğ‘–âˆ’1}ğ‘‘_ğ‘–\\
                    ğ‘ \theta _ğ‘–ğ‘ \alpha _{ğ‘–âˆ’1}&ğ‘\theta _ğ‘–ğ‘ \alpha _{ğ‘–âˆ’1}&ğ‘\alpha _{ğ‘–âˆ’1}&ğ‘\alpha _{ğ‘–âˆ’1}ğ‘‘_ğ‘–\\
                    0&0&0&1\\
            \end{matrix}
                \right]
\end{aligned}$$

è¿ç»­çš„ link transformation:

$$^{0}_{n}T = ^{0}_{1}T^{1}_{2}T^{2}_{3}T...^{n-2}_{n-1}T^{n-1}_{n}T$$

## 2.4 Examples

### 2.4.1 RRR

![ ](pics/4.png)

ä» {0} åˆ° {n}:

|i  |$\alpha_{i-1}$|$a_{i-1}$|$d_i$|$\theta_i$|
|-  |-             |-        |-    |-         |
|1  |0             |0        |0    |$\theta_1$|
|2  |0             |$L_1$    |0    |$\theta_2$|
|3  |0             |$L_2$    |0    |$\theta_3$|

å…¶ä¸­ $\theta_1,\theta_2,\theta_3$ ä¸ºå˜é‡ã€‚$L_1,L_2$ä¸ºå¸¸é‡ã€‚

> $\alpha_{i-1}$ åœ¨ joints å¤„äºåŒä¸€å¹³é¢æ—¶ä¸º 0ï¼Œè‹¥ä¸åŒå¹³é¢ï¼ˆä¸€èˆ¬æ˜¯å‚ç›´ï¼‰ä¸ºå…¶å¹³é¢å¤¹è§’ ã€‚$a_{i-1}$ ä¸€èˆ¬ä¸ºè¿æ†çš„é•¿åº¦ï¼Œ$d_i$ ä¸€èˆ¬æ˜¯è¿æ†çš„åšåº¦é€ æˆçš„ï¼Œ$\theta_i$ ä¸€èˆ¬ä¸ºä¸Šä¸€ä¸ªè¿æ†ä¸ä¸‹ä¸€ä¸ªè¿æ†ä¹‹é—´è§’åº¦ã€‚

### 2.4.2 RPR

![ ](pics/5.png)

ä» {0} åˆ° {n}:

|i  |$\alpha_{i-1}$|$a_{i-1}$|$d_i$|$\theta_i$|
|-  |-             |-        |-    |-         |
|1  |0             |0        |0    |$\theta_1$|
|2  |90Â°           |0        |$d_2$|0         |
|3  |0             |0        |$L_2$|$\theta_3$|

> è¿™é‡Œå¯¹äºä¹Ÿå¯ä»¥å°† {2} çš„ $d_i$ å†™æˆ 0ï¼Œ{3} çš„ $d_i$ å†™æˆ $d_2-L_2$

å¯¹äºåæ ‡è½´æ–¹å‘çš„é€‰ç€å…¶å®å¯ä»¥æœ‰å¾ˆå¤šç§ï¼š

![ ](pics/6.png)


## 2.5 DH standard

é™¤äº†æˆ‘ä»¬ä¸Šé¢ä»‹ç»çš„ DH Craig æ³•ä¹‹å¤–ï¼Œè¿˜æœ‰å¾ˆå¤šç§ DH æ³•ï¼Œå…¶ä¸­å¦å¤–ä¸€ç§å¸¸è§çš„æ–¹æ³•æ˜¯ DH standardã€‚ä¾ç„¶ä½¿ç”¨äº†ç±»ä¼¼ä¹‹å‰çš„ 4 ä¸ªå…ƒç´ ï¼Œä½†æ˜¯æ”¹å˜äº†å¯¹äºè¿™äº›å…ƒç´ çš„å–æ³•ã€‚

è¿™é‡Œå·ä¸ªæ‡’ï¼Œå°±ä¸è®²å…·ä½“æ¯ä¸ªå‚æ•°æ˜¯æ€ä¹ˆå®šä¹‰çš„ï¼Œä¹‹é—´ç”¨ä¾‹å’Œç»éªŒæ³•æ¥æè¿°ï¼š

ä¾æ—§æ˜¯å…ˆå‰é‚£ä¸ª PRP çš„ä¾‹å­ï¼Œä½¿ç”¨ DH Craig å†™å‡ºæ¥çš„ DH è¡¨ä¸ºï¼š

|i  |$\alpha_{i-1}$|$a_{i-1}$|$d_i$|$\theta_i$|
|-  |-             |-        |-    |-         |
|1  |0             |0        |0    |$\theta_1$|
|2  |0             |$L_1$    |0    |$\theta_2$|
|3  |0             |$L_2$    |0    |$\theta_3$|

![ ](pics/4.png)

è€Œä½¿ç”¨ DH standard å†™å‡ºæ¥çš„è¡¨ä¸ºï¼š

|i  |$\alpha_{i-1}$|$a_{i-1}$|$d_i$|$\theta_i$|
|-  |-             |-        |-    |-         |
|1  |0             |$L_1$    |0    |$\theta_1$|
|2  |0             |$L_2$    |0    |$\theta_2$|
|3  |0             |$L_3$    |0    |$\theta_3$|

> ä¸¤è€…ä¹‹é—´çš„åŒºåˆ«å¹¶ä¸å¤§ï¼Œåªæ˜¯ standard å°†ä¸‹ä¸€æ®µ link é•¿åº¦å˜æˆäº†å½“å‰æ®µçš„ç½¢äº†ã€‚

## 2.6 Matlab å®ç°

> é¦–å…ˆå…³äºåˆ—å‡ºä¸€äº› matlab robotics å¸¸ç”¨çš„ documents ç½‘ç«™ï¼š
> - [Matlab Robotics toolbox å®˜æ–¹æ–‡æ¡£](https://uk.mathworks.com/help/robotics/ref/rigidbodytree.show.html)
> - [Peter Corke å¤§ç¥çš„ç¬¬ä¸‰æ–¹ Robotics Toolbox](https://petercorke.com/toolboxes/robotics-toolbox/)
> - æ€•å›½å†…çš„åŒå­¦æ‰“ä¸å¼€ç½‘ç«™,æ‰€ä»¥æŠŠç½‘é¡µä¸Šå…³é”®çš„å†…å®¹å…‹éš†åˆ°æˆ‘çš„ç™¾åº¦äº‘äº†ï¼š [Peter Corke](https://pan.baidu.com/s/1IiOa7CKpuZEsx8U3VV8cAQ)ï¼Œæå–ç ï¼š0i9s


å¯¹äºä¸€ä¸ª 5 è½´æœºå™¨äººæ¥è¯´ï¼Œä½¿ç”¨ `Matlab` ä¸­çš„ `Livesript` æ•ˆæœå¦‚ä¸‹ï¼š

```matlab
% variable
pi = deg2rad(180);

%Parameters ( in cm)
link0_len = 5;
link1_len = 15;
link2_len = 15;
link3_len = 10;

% Join Limitation
J1_min = -pi;
J2_min = 0;
J3_min = -pi/2;
J4_min = -pi/2;
J5_min = -pi/2;
J1_max = pi;
J2_max = pi/2;
J3_max = 0;
J4_max = 0;
J5_max = pi/2;

%Standard DH
% Link([theta, d, a alpha])

L(1) = Link([0 link0_len 0 pi/2]);
L(2) = Link([0 link1_len 0 0]);
L(3) = Link([0 link2_len 0 0]);
L(4) = Link([0 0 0 pi/2]);
L(5) = Link([0 link2_len 0 0]);

Lynxmoiton = SerialLink(L,'name','Lynxmoiton');
Lynxmoiton.plot([0,0,0,0,0])
```
![ ](pics/7.png)

é€‚å½“æ¢ç´¢åï¼Œæ‰“ä¸ªå·¥ä½œç©ºé—´ç‚¹äº‘ä¹Ÿä¸æ˜¯é—®é¢˜ï¼š

![ ](pics/1.gif)

ä¸Šç¯‡ï¼š[Homogeneous Transformations - 2](https://zhuanlan.zhihu.com/p/426121325)

ä¸‹ç¯‡ï¼š[Inverse Kinematics]()


